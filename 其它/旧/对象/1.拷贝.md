c++的拷贝

###### 显示拷贝

c++23引入`auto()`和`auto{}`表达式，可以获取表达式对象的纯右值拷贝。如果表达式对象已经是纯右值，那么此操作无效。

当需要临时副本时，使用`auto()`或`auto{}`表达式相比显示创建一个副本对象时更好的选择。

###### 合成拷贝

如果类对象可以逐位次完成拷贝操作，编译器不会为其合成拷贝构造函数。

在以下情况，编译器会为没有定义拷贝构造的类合成拷贝构造：

1. 对象成员具有拷贝构造函数。

2. 基类具有拷贝构造函数。

3. 具有虚函数。

4. 继承链中有虚继承。
5. 使用`=default`显示让编译器合成。

>   合成的拷贝会进行值语义拷贝，如果某个类内部拥有引用语义的数据（指针或引用），最好自定义进行深拷贝。

###### 拷贝和继承

合成的拷贝控制函数，调用其基类的拷贝控制函数。如果基类中的拷贝控制函数不可访问，编译器将不会合成对应拷贝控制函数。

编译器不会自动调用基类的拷贝控制函数，需要显示调用父类的拷贝控制函数。

```cpp
struct Derive : public Base
{
    Derive(const Derive &other) : Base(other)
    {
        // TODO
    }

    Derive &operator=(const Derive &rhs)
    {
        Base::operator=(rhs);
        // TODO
    }
};
```



