[toc]

将程序中出现的名字与其声明连接的过程，称为名字查找。如在编译 `std::cout << std::endl;` 时，编译器进行以下步骤的名字查找：

* `std` 的无限定名字查找，找到全局命名空间中的命名空间 `std` 的声明。
* `cout` 的有限定名字查找，找到命名空间 `std` 中的变量声明。
* `endl` 的有限定名字查找，找到命名空间 `std` 中的函数模板声明。
* `operator<<` 的实参依赖查找，找到命名空间 `std` 中的多个模板函数声明。
* `std::ostream::operator<<` 的有限定名字查找，找到 `std::ostream` 类中的多个成员函数声明。

对于函数和函数模板的名字，名字查找可以将一个名字和多个声明连接起来，且可从实参依赖查找中得到额外的声明。之后进行模板实参推导，并将声明的集合交给重载决议，决定需要使用的声明。

当名字紧跟作用域解析运算符 `::` 之后时，进行有限定名字查找；否则，进行无限定名字查找。如果是函数调用，还会进行实参依赖查找。

## 无限定名字查找

未出现在 `::` 右侧的名字是无限定名，根据其出现的位置，照下述规则进行查找，当找到任何类型的第一个声明时停止查找。

##### 文件作用域内

只在文件作用域中进行查找，且查找范围仅限名字出现前的部分。

##### 命名空间作用域内

会沿着作用域从内向外查找，但查找范围仅限名字出现前的部分。

```cpp
namespace N1 {
	int x = 10;
	namespace N2 {
		int y = x;	// 找到 N1::x
		int x = 20;
		int z = x;	// 找到 N1::N2::x
	}
}
```

##### 命名空间外的定义

如果某个命名空间内部的成员在其外部定义，该定义中使用到的名字会以[命名空间作用域内](#命名空间作用域内)相同的规则进行查找，但查找范围为定义之前的所有部分。

```cpp
namespace N {
	extern int x;
	int n = 10;
}
int n = 20;
int N::x = n;	// 找到 N::n
```

##### 非成员函数的定义内

非成员函数的定义中，函数体或默认实参中出现的名字，首次查找范围为名字出现之前，至函数定义开始的部分，然后按照[命名空间外的定义](#命名空间外的定义)相同的规则进行查找。

```cpp
namespace N {
    auto func() -> void;
	int n = 10;
}
int n = 20;
auto N::func() -> void {
	int i = n;	// 找到 N::n
}
```

##### 成员函数的定义内



##### 默认实参

默认实参，或构造函数的成员初始化器的表达式部分使用的名字，会先检查函数形参中出现的名字。

```cpp
struct T {
	constexpr static int i = 10;
	T(int i = 20) : n{ i } {}	// 找到i
	int n;
};
```

##### 枚举项的声明

在枚举项的声明的初始化器部分中使用的无限定名字，会先检查当前枚举中之前的枚举项。

```cpp
const int N = 10;
enum class E {
	I = N,	// 找到 ::N
	N = 20,
	J = N,	// 找到 E::N
};
```

## 有限定名字查找

